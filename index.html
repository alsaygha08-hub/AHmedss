<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English 3 Offline</title>
    <link rel="stylesheet" href="./jquery-ui.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: #f5f5f5;
        }
        #overlay {
            position: fixed;
            top:0; left:0; right:0; bottom:0;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            z-index: 9999;
        }
    </style>
</head>
<body>
    <div id="overlay">جار التحميل...</div>

    <h1>English 3</h1>
    <p id="pto"></p>
    <button id="butt2" style="display:none;">التالي</button>

    <!-- مكتبات أساسية -->
    <script src="./jquery-3.6.4.min.js"></script>
    <script src="./jquery-ui.min.js"></script>
    <script src="./jquery.ui.touch-punch.min.js"></script>

    <!-- ملف الأسئلة المحلي -->
    <script src="./prompts_local.js"></script>

    <!-- كود التشغيل -->
    <script>
        function initLocal() {
            if (!window.PROMPTS_LOCAL || !window.PROMPTS_LOCAL.length) {
                console.error("❌ ملف الأسئلة prompts_local.js غير محمّل أو فاضي");
                alert("خطأ: ملف الأسئلة غير موجود أو فاضي");
                return;
            }

            window.promptBank = window.PROMPTS_LOCAL.slice(0, 12);
            window.sounds = promptBank.map((p, i) => './' + (p.audio ? p.audio : ('g' + (i + 1) + '.mp3')));
            window.audioElements = sounds.map(f => {
                const a = new Audio(f);
                a.onended = () => $("#butt2").fadeIn();
                return a;
            });

            $("#pto").text("عدد الأسئلة: " + promptBank.length);
            document.getElementById("overlay").style.display = "none";
        }

        window.addEventListener("load", initLocal);
    </script>
</body>
</html>
